GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0001

LINE    PG/LN  A...B............................................................SEQUENCE

000001        *=========================== READIDX ============================*
000002        * Authors: Brian D Pead
000003        *
000004        * License: MIT
000005        *
000006        * Description: Test reading the indexed file created by program
000007        *              BLDFILES.
000008        *
000009        * Date        Version  Description
000010        * ----        -------  -----------
000011        * 2020-01-24  0.1      First release
000012        *================================================================*
000013
000014         IDENTIFICATION DIVISION.
000015        *========================
000016
000017         PROGRAM-ID.                 READIDX.
000018
000019         ENVIRONMENT DIVISION.
000020        *=====================
000021
000022         CONFIGURATION SECTION.
000023        *----------------------
000024
000025         SOURCE-COMPUTER.
000026             IBM-Z15.
000027        *    IBM-Z15 DEBUGGING MODE.
000028
000029         INPUT-OUTPUT SECTION.
000030        *---------------------
000031
000032         FILE-CONTROL.
000033             SELECT NAMADDIX         ASSIGN "Data\NAMEADDR.Idx.dat"
000034                                     ORGANIZATION INDEXED
000035                                     ACCESS DYNAMIC
000036                                     RECORD KEY NA-TAXID
000037                                     ALTERNATE KEY NA-LAST-NAME
000038                                         WITH DUPLICATES
000039                                     FILE STATUS W-FILE-STATUS.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0002

LINE    PG/LN  A...B............................................................SEQUENCE

000040        /
000041         DATA DIVISION.
000042        *==============
000043
000044         FILE SECTION.
000045        *-------------
000046
000047         FD  NAMADDIX.
000048
000049         01  NAMADDIX-REC.           COPY NAMEADDR.
000001C       *01  NAMEADDR-REC.
000002C            05  NA-TAXID            PIC X(12).
000003C            05  NA-NAME.
000004C                10  NA-PREFIX       PIC X(10).
000005C                10  NA-FIRST-NAME   PIC X(25).
000006C                10  NA-LAST-NAME    PIC X(35).
000007C                10  NA-SUFFIX       PIC X(10).
000008C            05  NA-ADDRESS.
000009C                10  NA-STREET       PIC X(35).
000010C                10  NA-CITY         PIC X(25).
000011C                10  NA-STATE        PIC X(10).
000012C                10  NA-ZIP-CODE     PIC X(10).
warning: line not terminated by a newline
000050
000051         WORKING-STORAGE SECTION.
000052        *------------------------
000053
000054         01  W-NAMADDIX-RECS         PIC 9(09)  COMP VALUE 0.
000055         01  W-RETURN-CODE           PIC S9(04) COMP.
000056         01  W-DISP-NUM              PIC ZZ,ZZ9.
000057
000058         01  W-ERROR-MSG             PIC X(20)       VALUE
000059             '**** READIDX error: '.
000060
000061         01  W-READ-SEQUENCE         PIC X(01).
000062             88  W-READ-SEQUENCE-LAST-NAME           VALUE 'l'
000063                                                           'L'.
000064
000065         01  FILLER                  PIC X(01)       VALUE 'N'.
000066             88  W-EOF                               VALUE 'Y'.
000067
000068         01  W-FILE-STATUS           PIC X(02).
000069             88  W-FILE-STATUS-GOOD                  VALUE '00'.
000070
000071         01  W-COMPILED-DATE.
000072             05  W-COMPILED-DATE-YYYY
000073                                     PIC X(04).
000074             05  W-COMPILED-DATE-MM  PIC X(02).
000075             05  W-COMPILED-DATE-DD  PIC X(02).
000076             05  W-COMPILED-TIME-HH  PIC X(02).
000077             05  W-COMPILED-TIME-MM  PIC X(02).
000078             05  W-COMPILED-TIME-SS  PIC X(02).
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0003

LINE    PG/LN  A...B............................................................SEQUENCE

000079             05  FILLER              PIC X(07).
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0004

LINE    PG/LN  A...B............................................................SEQUENCE

000080        /
000081         PROCEDURE DIVISION.
000082        *===================
000083
000084         MAIN.
000085        *-----
000086
000087             PERFORM SUB-1000-START-UP THRU SUB-1000-EXIT
000088
000089             IF      W-RETURN-CODE NOT = 0
000090                 GO TO MAIN-EXIT
000091             END-IF
000092
000093             PERFORM SUB-9200-READ-NAMADDIX THRU SUB-9200-EXIT
000094
000095             PERFORM SUB-2000-PROCESS THRU SUB-2000-EXIT
000096                 UNTIL W-EOF
000097                 OR    W-RETURN-CODE NOT = 0
000098
000099             PERFORM SUB-3000-SHUT-DOWN THRU SUB-3000-EXIT
000100             .
000101         MAIN-EXIT.
000102             STOP RUN.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0005

LINE    PG/LN  A...B............................................................SEQUENCE

000103        /
000104         SUB-1000-START-UP.
000105        *------------------
000106
000107             MOVE 0                  TO W-RETURN-CODE
000108             MOVE FUNCTION WHEN-COMPILED
000109                                     TO W-COMPILED-DATE
000110
000111             DISPLAY 'READIDX compiled on '
000112                 W-COMPILED-DATE-YYYY '/'
000113                 W-COMPILED-DATE-MM   '/'
000114                 W-COMPILED-DATE-DD   ' at '
000115                 W-COMPILED-TIME-HH   ':'
000116                 W-COMPILED-TIME-MM   ':'
000117                 W-COMPILED-TIME-SS
000118
000119             OPEN INPUT NAMADDIX
000120
000121             IF      NOT W-FILE-STATUS-GOOD
000122                 DISPLAY W-ERROR-MSG
000123                         'File status '
000124                         W-FILE-STATUS
000125                         ' opening NAMADDIX'
000126                 MOVE 10             TO W-RETURN-CODE
000127                 GO TO SUB-1000-EXIT
000128             END-IF
000129
000130             DISPLAY 'Enter read sequence '
000131                     '(T for Taxid, L for Last Name): '
000132                 NO ADVANCING
000133
000134             ACCEPT W-READ-SEQUENCE
000135
000136             IF      NOT W-READ-SEQUENCE-LAST-NAME
000137                 GO TO SUB-1000-EXIT
000138             END-IF
000139
000140             PERFORM SUB-9100-START-NAMADDIX THRU SUB-9100-EXIT
000141             .
000142         SUB-1000-EXIT.
000143             EXIT.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0006

LINE    PG/LN  A...B............................................................SEQUENCE

000144        /
000145         SUB-2000-PROCESS.
000146        *-----------------
000147
000148             DISPLAY NAMADDIX-REC
000149
000150             PERFORM SUB-9200-READ-NAMADDIX THRU SUB-9200-EXIT
000151             .
000152         SUB-2000-EXIT.
000153             EXIT.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0007

LINE    PG/LN  A...B............................................................SEQUENCE

000154        /
000155         SUB-3000-SHUT-DOWN.
000156        *-------------------
000157
000158             CLOSE NAMADDIX
000159
000160             MOVE W-NAMADDIX-RECS    TO W-DISP-NUM
000161             DISPLAY 'NAMADDIX records read:    '
000162                     W-DISP-NUM
000163
000164             DISPLAY 'READIDX Completed'
000165             .
000166         SUB-3000-EXIT.
000167             EXIT.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0008

LINE    PG/LN  A...B............................................................SEQUENCE

000168        /
000169         SUB-9100-START-NAMADDIX.
000170        *------------------------
000171
000172             MOVE SPACES             TO NA-LAST-NAME
000173
000174             START NAMADDIX
000175                 KEY >= NA-LAST-NAME
000176             END-START
000177
000178             IF      NOT W-FILE-STATUS-GOOD
000179                 DISPLAY W-ERROR-MSG
000180                         'File status '
000181                         W-FILE-STATUS
000182                         ' starting NAMADDIX'
000183                 MOVE 20             TO W-RETURN-CODE
000184             END-IF
000185             .
000186         SUB-9100-EXIT.
000187             EXIT.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0009

LINE    PG/LN  A...B............................................................SEQUENCE

000188        /
000189         SUB-9200-READ-NAMADDIX.
000190        *-----------------------
000191
000192             READ NAMADDIX NEXT
000193                 AT END
000194                     SET  W-EOF      TO TRUE
000195                     GO TO SUB-9200-EXIT
000196             END-READ
000197
000198             ADD  1                  TO W-NAMADDIX-RECS
000199
000200             IF      NOT W-FILE-STATUS-GOOD
000201                 DISPLAY W-ERROR-MSG
000202                         'File status '
000203                         W-FILE-STATUS
000204                         ' reading NAMADDIX'
000205                 MOVE 30             TO W-RETURN-CODE
000206             END-IF
000207             .
000208         SUB-9200-EXIT.
000209             EXIT.
GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0010

SIZE  TYPE           LVL  NAME                           PICTURE

00172 FILE                NAMADDIX
00172 GROUP          01   NAMADDIX-REC
00012 ALPHANUMERIC   05   NA-TAXID                       X(12)
00080 GROUP          05   NA-NAME
00010 ALPHANUMERIC   10   NA-PREFIX                      X(10)
00025 ALPHANUMERIC   10   NA-FIRST-NAME                  X(25)
00035 ALPHANUMERIC   10   NA-LAST-NAME                   X(35)
00010 ALPHANUMERIC   10   NA-SUFFIX                      X(10)
00080 GROUP          05   NA-ADDRESS
00035 ALPHANUMERIC   10   NA-STREET                      X(35)
00025 ALPHANUMERIC   10   NA-CITY                        X(25)
00010 ALPHANUMERIC   10   NA-STATE                       X(10)
00010 ALPHANUMERIC   10   NA-ZIP-CODE                    X(10)

      WORKING-STORAGE SECTION

00004 NUMERIC        01   W-NAMADDIX-RECS                9(09) COMP

00002 NUMERIC        01   W-RETURN-CODE                  S9(04) COMP

00006 NUMERIC        01   W-DISP-NUM                     ZZ,ZZ9

00020 ALPHANUMERIC   01   W-ERROR-MSG                    X(20)

00001 ALPHANUMERIC   01   W-READ-SEQUENCE                X(01)
      CONDITIONAL    88   W-READ-SEQUENCE-LAST-NAME

00001 ALPHANUMERIC   01   FILLER                         X(01)
      CONDITIONAL    88   W-EOF

00002 ALPHANUMERIC   01   W-FILE-STATUS                  X(02)
      CONDITIONAL    88   W-FILE-STATUS-GOOD

00021 GROUP          01   W-COMPILED-DATE
00004 ALPHANUMERIC   05   W-COMPILED-DATE-YYYY           X(04)
00002 ALPHANUMERIC   05   W-COMPILED-DATE-MM             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-DATE-DD             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-HH             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-MM             X(02)
00002 ALPHANUMERIC   05   W-COMPILED-TIME-SS             X(02)
00007 ALPHANUMERIC   05   FILLER                         X(07)


GnuCOBOL 3.0-rc1.0      READIDX.cob                                                   Fri Jan 24 23:46:50 2020  Page 0011

Error/Warning summary:

E:/Users/Brian D Pead/Documents/GnuCOBOL Projects/GC-Examples/CopyBooks/NAMEADDR.CPY:12: warning: line not terminated by a newline

1 warning in compilation group
0 errors in compilation group
